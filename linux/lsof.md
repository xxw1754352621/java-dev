# [lsof](https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/lsof.html)（list open files）

是一个查看当前系统文件的工具。

在linux环境下，任何事物都以文件的形式存在，通过文件不仅仅可以访问常规数据，还可以访问网络连接和硬件。如传输控制协议 (TCP) 和用户数据报协议 (UDP) 套接字等，系统在后台都为该应用程序分配了一个文件描述符，该文件描述符提供了大量关于这个应用程序本身的信息。

# 打开的文件列表如下：

1. **普通文件**
2. 目录
3. **网络文件系统的文件**
4. 字符或设备文件
5. (函数)共享库
6. 管道，命名管道
7. 符号链接
8. **网络文件（例如：NFS file、网络socket，unix域名socket）**
9. 还有其它类型的文件，等等

# 输入参数：

- -a 列出打开文件存在的进程
- -c<进程名> 列出指定进程所打开的文件
- -g 列出GID号进程详情
- -d<文件号> 列出占用该文件号的进程
- +d<目录> 列出目录下被打开的文件
- +D<目录> 递归列出目录下被打开的文件
- -n<目录> 列出使用NFS的文件
- **-i<条件> 列出符合条件的进程。（4、6、协议、:端口、 @ip ）**
- -p<进程号> 列出指定进程号所打开的文件
- -u 列出UID号进程详情
- -h 显示帮助信息
- -v 显示版本信息

# 输入参数：

TYPE：文件类型，如DIR、REG等，常见的文件类型:

```properties
（1）DIR：表示目录
（2）CHR：表示字符类型
（3）BLK：块设备类型
（4）UNIX： UNIX 域套接字
（5）FIFO：先进先出 (FIFO) 队列
（6）IPv4：网际协议 (IP) 套接字
```

NODE：索引节点（文件在磁盘上的标识）

# 实例：

```properties
lsof -p 4721 -nP | grep TCP
列出所有tcp 网络连接信息
-nP ：参数用于将 ip 地址和端口号显示为正常的数值类型，否则可能会用别名表示
```

[lsof -i:port](http://www.361way.com/lsof-ss-netstat/4351.html)命令执行时间会长是因为，其会尝试进行反解析，将主机转化为主机名（域名），将端口转化为对应的服务，当然耗时了。所以平时查询时，最好加上-n -P参数。