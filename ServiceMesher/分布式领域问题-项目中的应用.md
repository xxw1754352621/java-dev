# 分布式领域问题-项目中的应用

## 分布式存储理论

CAP : Consistency Availability Partition tolerance 只能满足其二

BASE :Basically Available（基本可用）Soft state（柔性状态）Eventually consistent（最终一致）

Quorum NRW

## 分布式存储模型

Consistent hash,(去中心化 ) -->memcahed
B+ tree (实时,随机) -->mongodb
LSM tree, (批量 顺序) -->hbase



## 分布式事务

**一致性模型**

主要有三种：

1. **Strong Consistency**（强一致性）：新的数据一旦写入，在任意副本任意时刻都能读到新值。比如：文件系统，RDBMS，Azure Table都是强一致性的。
2. **Week Consistency**（弱一致性）：不同副本上的值有新有旧，需要应用方做更多的工作获取最新值。比如Dynamo。
3. **Evantual Consistency**（最终一致性）：一旦更新成功，各副本的数据最终将达到一致。

分布式事务解决方案

1. 基于XA

 



## 原则与目标

原则： kiss
 来源 : unix 设计哲学
 产品 -->微信摇一摇 苹果新手入门
 技术 --->个性化推荐

目标: RAS
RAS: Reliability, Availability, Scalability 高可靠，高可用，高扩展



## 项目中的应用

### 分布式事务应用

项目：pds-gos

业务描述：

- 强一致性
  - gos系统下单，oper系统计费
    - oper计费失败，则两边都回滚
    - oper计费成功
      - gos保存下单数据成功
      - gos保存下单数据失败，oper事务提交成功，目前gos没有做保证下单成功处理
        - 方案
          - 1.原有基础上，数据保存失败
            - 最大努力重试+mongodb等落地+钉钉通知+**人工接入**
          - 2.分布式事务解决方案的引入
            - 最终一致性

流程图：

### 分布式中间件应用

项目：pkg到hwms

业务描述：第三方数据预报到末端系统（pkg），末端系统处理

流程图：

### 分布式存储应用

项目：pickup

业务描述：

流程图：



[^1]: [分布式系统架构](http://book.mixu.net/distsys/)
[^2]: [分布式系统书籍](http://book.mixu.net/distsys/)
[^3]: [分布式经典论文](https://www.zhihu.com/question/30026369)

